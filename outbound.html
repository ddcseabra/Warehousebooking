<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>New Outbound booking</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <style>
    :root {
      --primary-color: #4A55A2;
      --light-gray: #f0f2f5;
      --dark-gray: #555;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Sarabun', sans-serif;
      background-image: url('https://images.unsplash.com/photo-1586528116311-06924151d18a?q=80&w=2070&auto=format&fit=crop');
      background-size: cover;
      background-position: center;
      min-height: 100vh;
      color: var(--dark-gray);
    }
    .header-container {
      padding: 20px;
      display: flex;
      justify-content: space-between;
      background: var(--primary-color);
      height: 10vh;
      width: 100%;
    }
    .header-img { height: 100%; }
    .header-list {
      display: flex;
      list-style: none;
      gap: 20px;
      height: 100%;
      align-items: center;
      a {
        text-decoration: none;
        color: #fff;
        
      }
    }
    .header-list li.active a {
  border-bottom: 2px solid #fff; /* ‡πÄ‡∏™‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß */
  font-weight: 600;              /* ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏≤‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
}
.main-container {
      max-width: 1000px;
      justify-self: center;
    }
    h1 { padding: 20px; }
    fieldset {
      display: flex;
      flex-direction: column;
      border: none;
      padding: 20px;
      gap: 10px;
      background: rgba(255,255,255,0.8);
      border-radius: 10px;
    }
    select, input, textarea { padding: 10px; font-size: 16px; }
    input { width: 100%; }
    .form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 20px;
      padding: 0 20px 20px;
    }
    input[type="date"],
    input[type="time"] {
      cursor: pointer;
    }
    #save-button { background-color: #63A89A; padding:10px 30px; border:none; color:white; border-radius:5px; font-weight:600; cursor:pointer;}
    #cancel-button { background-color: rgba(163,22,33,1); padding:10px 30px; border:none; color:white; border-radius:5px; font-weight:600; cursor:pointer;}
  </style>
</head>
<body>

<header>
  <div class="header-container">
    <a href="#"><img src="/img/home.png" class="header-img" alt=""></a>
    <nav>
      <ul class="header-list">
        <li><a href="inbound.html">Inbound</a></li>
        <li class="active"><a href="#">Outbound</a></li>
        <li><a href="#">Stock</a></li>
      </ul>
    </nav>
    <a href="#"><img src="/img/user.png" class="header-img" alt=""></a>
  </div>
</header>

<main>
  <div class="main-container">
<section class="booking-section">
  <h1>Create New Outbound Booking</h1>

  <fieldset>
    <label for="service">Select Service üöö</label>
    <select id="service" required>
      <option value="general-storage" selected>General Storage</option>
      <option value="cold-storage">Cold Storage</option>
    </select>

    <label for="sub-service">Select Sub-Service üöö</label>
    <select id="sub-service" required>
      <option value="">-- Select Sub-Service --</option>
    </select>
  </fieldset>

  <fieldset>
    <label for="booking-date">Date üìÖ</label>
    <input type="date" id="booking-date" required>

    <label for="booking-time">Time üïí</label>
    <input type="time" id="booking-time" required>
  </fieldset>

  <fieldset>
    <label for="remark">Remark üí¨</label>
    <textarea id="remark" rows="4" placeholder="Enter remark ..." style="resize: none;"></textarea>
  </fieldset>

  <div class="form-actions">
    <button type="button" id="cancel-button">Cancel</button>
    <button type="button" id="save-button">Save</button>
  </div>

</section>
</div>
</main>

<script>
const webAppUrl = "https://script.google.com/macros/s/AKfycbxzyUwsTxDll7QVH0eFwcA_DufRJV48eh-BtPISn3A5QkiOaeMnsMdjHzXgm4HawpQn/exec";

const subServiceOptions = {
  "general-storage":[
    {value:"gs-storage-area",text:"Storage Area 5,000 SQ.M"},
    {value:"gs-load-unload",text:"Load & Unload Container 20' & 40'"},
    {value:"gs-repack-lashing",text:"Repack Wrap & Lashing product on pallet"},
    {value:"gs-distribution-dc",text:"Distribution on DC and Drop off point"},
    {value:"gs-wooden-fumigate",text:"Wooden case with fumigate and certificate"}
  ],
  "cold-storage":[
    {value:"cs-control-room",text:"Control room 25 degree"},
    {value:"cs-chill-room",text:"Chill room 2-6 degree"},
    {value:"cs-frozen-room",text:"Frozen room -18 degree"},
    {value:"cs-distribution-temp",text:"Distribution all temperature controlled to all destination"},
    {value:"cs-prime-location",text:"Prime location"}
  ]
};

const serviceSelect = document.getElementById("service");
const subServiceSelect = document.getElementById("sub-service");
const bookingDate = document.getElementById("booking-date");
const bookingTime = document.getElementById("booking-time");
const remark = document.getElementById("remark");
const saveButton = document.getElementById("save-button");
const cancelButton = document.getElementById("cancel-button");

// Update sub-service options
function updateSubServices(){
  const selected = serviceSelect.value;
  subServiceSelect.innerHTML = '<option value="">-- Select Sub-Service --</option>';
  subServiceOptions[selected].forEach(opt=>{
    const option = document.createElement("option");
    option.value = opt.value;
    option.textContent = opt.text;
    subServiceSelect.appendChild(option);
  });
}

serviceSelect.addEventListener("change", updateSubServices);
updateSubServices();

cancelButton.addEventListener("click", ()=>{
  if(confirm("Are you sure you want to cancel? All data will be cleared.")){
    serviceSelect.value = "general-storage";
    bookingDate.value = "";
    bookingTime.value = "";
    remark.value = "";
    updateSubServices();
  }
});

saveButton.addEventListener("click", ()=>{
  const service = serviceSelect.selectedOptions[0].text;
  const subService = subServiceSelect.selectedOptions[0].text;
  const date = bookingDate.value;
  const time = bookingTime.value;
  const remarkValue = remark.value;

  if(!service || !subService || !date || !time){
    alert("Please fill in all required fields!");
    return;
  }

  // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Web App
  const url = `${webAppUrl}?type=Outbound&service=${encodeURIComponent(service)}&subService=${encodeURIComponent(subService)}&date=${encodeURIComponent(date)}&time=${encodeURIComponent(time)}&remark=${encodeURIComponent(remarkValue)}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      if(data.status === "success"){
        alert("Booking saved! ID: " + data.bookingId);
        serviceSelect.value = "general-storage";
        bookingDate.value = "";
        bookingTime.value = "";
        remark.value = "";
        updateSubServices();
      } else {
        alert("Error: " + data.message);
      }
    })
    .catch(err => alert("Error: " + err));
});
</script>

</body>
</html>
